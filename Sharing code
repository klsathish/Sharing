 public async Task<AuthenticationResponse> AuthenticateAsync(string userName, string ipAddress, string browser)
 {
     AuthenticationResponse responseAuth = new AuthenticationResponse();
     if (!string.IsNullOrEmpty(userName))
     {
         var user = await _accountRepository.GetUserbyLoginIdAsync(userName);

         if (user != null && user.Count > 0)
         {
             var userData = await _accountRepository.GetDataForAuthenticationByUserIdAsync(Convert.ToInt32(user[0].UserID));

             var role = user[0].RoleID;
             if (role == 0)
             {
                 responseAuth.Token = null;
                 responseAuth.StatusCode = SabicConstants.UnAuthorizedStatusCode;
                 return responseAuth;
             }

             var jwtSecurityToken = await GenerateToken(user[0], ipAddress, browser, 1, userData);
             if (jwtSecurityToken == null)
             {
                 responseAuth.Token = null;
                 responseAuth.StatusCode = SabicConstants.UnAuthorizedStatusCode;
                 return responseAuth;
             }
             responseAuth.Token = jwtSecurityToken;
             responseAuth.StatusCode = SabicConstants.SuccessStatusCode;
             return responseAuth;
         }
         else
         {
             //TODO AD service check user role (need to create task)
             responseAuth.Token = null;
             responseAuth.StatusCode = SabicConstants.UnAuthorizedStatusCode;
             return responseAuth;
         }
     }
     responseAuth.Token = null;
     responseAuth.StatusCode = SabicConstants.UnAuthorizedStatusCode;
     return responseAuth;
 }



    [Fact]
    public async Task AuthenticateAsync_WhenValidUser_ReturnsToken()
    {
        var expextedReponse = new List<UserAuth> { new UserAuth { UserID = 1, RoleID = 2 }, new UserAuth { UserID = 11, RoleID = 2 } };

        _accountRepoMock.Setup(x => x.GetUserbyLoginIdAsync(It.IsAny<string>())).ReturnsAsync(expextedReponse);

        _accountRepoMock.Setup(x => x.GetDataForAuthenticationByUserIdAsync(1)).ReturnsAsync(new GetDataForAuthenticationByUserId());

        var jwtSettings = Options.Create(new JwtSettings
        {
            Key = "15433DGB66934ECC86D547C5CF4F2EFC345123tsadt", // Must be â‰¥ 32 characters
            Issuer = "TestIssuer",
            Audience = "TestAudience",
            DurationInMinutes = 20,
            AesKey = "r25db5898a4e4133bbce2ea2315a1927"

        });


        var mockAccountRepo = new Mock<IAccountRepository>();
        var mockLoggingRepo = new Mock<ILoggingRepository>();


        var _service = new AuthenticationService(jwtSettings, mockAccountRepo.Object, mockLoggingRepo.Object);
        //mock.Setup(x => x.GenerateToken(It.IsAny<UserAuth>(), It.IsAny<string>(), It.IsAny<string>(), It.IsAny<int>(), It.IsAny<GetDataForAuthenticationByUserId>())).ReturnsAsync("jwt-token");

        /*
     System.NotSupportedException : Unsupported expression: 
    x => x.GenerateToken(It.IsAny<UserAuth>(), It.IsAny<string>(), It.IsAny<string>(), It.IsAny<int>(), It.IsAny<GetDataForAuthenticationByUserId>())
Non-overridable members (here: AuthenticationService.GenerateToken) may not be used in setup / verification expressions.

     */
        var result = await _service.AuthenticateAsync("sabiccorp\\30790093", "1.1.1.1", "Chrome");

        Assert.Equal(SabicConstants.UnAuthorizedStatusCode, result.StatusCode);
        //Assert.Equal("jwt-token", result.Token);
    }


