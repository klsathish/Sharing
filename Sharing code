INSERT INTO TRN_Delegation  
  (    
   --DelegationID  
    FromUserDomainLoginID  
   ,ToUserDomainLoginID  
   ,StartDate  
   ,EndDate  
   ,IsActive  
   ,CreatedBy  
   ,CreatedDate  
   ,UpdatedBy  
   ,UpdatedDate   
   ,Role  
  )    
  VALUES  
  (    
    @FromUserDomainLoginID  
   ,@ToUserDomainLoginID  
   ,@StartDate  
   ,@EndDate  
   ,@IsEnable  
   ,@CreatedBy  
   ,@CreatedDate  
   ,NULL  
   ,NULL  
   ,(  
      SELECT top 1 R.RoleName   
     FROM [SABIC_DT_Finance_SF_WebUI].[dbo].[ADM_User] AS W  
     INNER JOIN [SABIC_DT_Finance_SF_WebUI].[dbo].[ADM_UserRoleMapping] AS ADM  
     ON W.UserID = ADM.UserID  
     INNER JOIN [SABIC_DT_Finance_SF_WebUI].[dbo].[ADM_Role] AS R  
     ON ADM.RoleID = R.RoleID  
     WHERE   
       W.IsActive = 1  
     AND ADM.IsActive = 1  
	 AND ADM.IsSelectedRole=1
	-- AND R.RoleID in (13,11,10,14,12)
	AND R.RoleName in (
		'SNOP Manager','EPM Manager','EPM Planner','SNOP Planner','BU Manager','Admin','FBP Analyst','FBP Manager'
	)
     AND W.Username = @FromUserDomainLoginID  
   )  
  )  
