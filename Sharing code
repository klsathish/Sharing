 [HttpPost("insertAPIRequestLogsAndPerformanceLogs")]
 public async Task<IActionResult> InsertAPIRequestLogsAndPerformanceLogs([FromBody] ApiRequestAndPerformanceLogRequest apiRequestAndPerformanceLogRequest)
 {
     ApiRequestAndPerformanceLogModel apiRequestAndPerformanceLogModel = new ApiRequestAndPerformanceLogModel();
     var loginSession = CommonUtils.GetCurrentSession(HttpContext);
     if (!string.IsNullOrEmpty(loginSession) && loginSession.Contains(":"))
     {
         var inpSes = loginSession.Split(':');
         apiRequestAndPerformanceLogModel.UserID = !string.IsNullOrEmpty(inpSes[0]) ? Int32.Parse(inpSes[0]) : 0;
         apiRequestAndPerformanceLogModel.SessionID = inpSes[1];
         apiRequestAndPerformanceLogModel.RoleID = !string.IsNullOrEmpty(inpSes[2]) ? Int32.Parse(inpSes[2]) : 0;
         apiRequestAndPerformanceLogModel.EmployeeName = inpSes[3];
         apiRequestAndPerformanceLogModel.CreatedBy = inpSes[3];
     }
     apiRequestAndPerformanceLogModel.CreatedOn = DateTime.Now;
     TimeSpan elapsedTime = apiRequestAndPerformanceLogRequest.ResponseTimeStamp - apiRequestAndPerformanceLogRequest.RequestTimeStamp;
     apiRequestAndPerformanceLogModel.Duration = $"{elapsedTime.TotalMilliseconds} ms";
     var response = await _iAPIRequestLogService.InsertAPIRequestLogsAndPerformanceLogs(apiRequestAndPerformanceLogRequest, apiRequestAndPerformanceLogModel);
     return StatusCode(response.StatusCode, response);
 }


[ExcludeFromCodeCoverage]
public class ApiRequestAndPerformanceLogRequest
{
    public int AppModuleMappingID { get; set; }
    public string? ApiEndPoint { get; set; }
    public string? RequestBody { get; set; }
    public string? HttpMethod { get; set; }
    public int? StatusCode { get; set; }
    public DateTime RequestTimeStamp { get; set; }
    public string? ResponseBody { get; set; }
    public DateTime ResponseTimeStamp { get; set; }
    public int? LayerID { get; set; }
    public string? ComponentName { get; set; }
    public string? ActionName { get; set; }
}
[ExcludeFromCodeCoverage]
public class ApiRequestAndPerformanceLogModel
{
    public int UserID { get; set; }
    public int RoleID { get; set; }
    public string? EmployeeName { get; set; }
    public string? RoleName { get; set; }
    public string? SessionID { get; set; }
    public string? Duration { get; set; }
    public string? CreatedBy { get; set; }
    public DateTime CreatedOn { get; set; }
}



        public async Task<string> InsertAPIRequestLogsAndPerformanceLogs(ApiRequestAndPerformanceLogRequest apiRequestAndPerformanceLogRequest, ApiRequestAndPerformanceLogModel apiRequestAndPerformanceLogModel)
        {
            var apiRequestLog = await _dbContext.Database.ExecuteSqlRawAsync("EXEC [dbo].[SP_Insert_Update_APIRequestLog] {0},{1},{2},{3},{4},{5},{6},{7},{8},{9},{10},{11},{12},{13},{14}"
                   , 0
                   , apiRequestAndPerformanceLogModel.UserID
                   , apiRequestAndPerformanceLogModel.RoleID
                   , apiRequestAndPerformanceLogModel.SessionID
                   , apiRequestAndPerformanceLogRequest.AppModuleMappingID
                   , apiRequestAndPerformanceLogRequest.ApiEndPoint
                   , apiRequestAndPerformanceLogRequest.HttpMethod
                   , apiRequestAndPerformanceLogRequest.StatusCode
                   , apiRequestAndPerformanceLogRequest.RequestBody
                   , apiRequestAndPerformanceLogRequest.RequestTimeStamp
                   , apiRequestAndPerformanceLogRequest.ResponseBody
                   , apiRequestAndPerformanceLogRequest.RequestTimeStamp
                   , apiRequestAndPerformanceLogModel.Duration
                   , apiRequestAndPerformanceLogModel.CreatedBy
                   , apiRequestAndPerformanceLogRequest.LayerID
                   );
            if (apiRequestLog == 0)
            {
                return SabicConstants.BadRequestMessage;
            }
            var performanceLog = await _dbContext.Database.ExecuteSqlRawAsync("EXEC [dbo].[SP_Insert_Update_PerformanceLog] {0},{1},{2},{3},{4},{5},{6},{7},{8},{9},{10}"
                   , 0
                   , apiRequestAndPerformanceLogModel.UserID
                   , apiRequestAndPerformanceLogModel.RoleID
                   , apiRequestAndPerformanceLogModel.SessionID
                   , apiRequestAndPerformanceLogRequest.ComponentName
                   , apiRequestAndPerformanceLogRequest.ActionName
                   , apiRequestAndPerformanceLogRequest.RequestTimeStamp
                   , apiRequestAndPerformanceLogRequest.ResponseTimeStamp
                   , apiRequestAndPerformanceLogModel.Duration
                   , apiRequestAndPerformanceLogModel.CreatedBy
                   , apiRequestAndPerformanceLogModel.CreatedOn
                   );
            if (performanceLog == 0)
            {
                return SabicConstants.BadRequestMessage;
            }
            return SabicConstants.SuccessMessage;
        }


need to work 
Performance Log - need to log every API call which are called, need to log from middleware not from react
Restrict the page access using role level routing from middleware  

