[Fact]
public async Task AuthenticateAsync_WhenValidUser_ReturnsToken()
{
    // Arrange
    var users = new List<UserAuth>
    {
        new UserAuth
        {
            UserID = 1,
            RoleID = 2
        }
    };

    var accountRepoMock = new Mock<IAccountRepository>();
    var loggingRepoMock = new Mock<ILoggingRepository>();

    accountRepoMock
        .Setup(x => x.GetUserbyLoginIdAsync(It.IsAny<string>()))
        .ReturnsAsync(users);

    accountRepoMock
        .Setup(x => x.GetDataForAuthenticationByUserIdAsync(1))
        .ReturnsAsync(new GetDataForAuthenticationByUserId());

    var jwtSettings = Options.Create(new JwtSettings
    {
        Key = "15433DGB66934ECC86D547C5CF4F2EFC345123tsadt",
        Issuer = "TestIssuer",
        Audience = "TestAudience",
        DurationInMinutes = 20,
        AesKey = "r25db5898a4e4133bbce2ea2315a1927"
    });

    var service = new AuthenticationService(
        jwtSettings,
        accountRepoMock.Object,
        loggingRepoMock.Object
    );

    // Act
    var result = await service.AuthenticateAsync(
        "sabiccorp\\30790093",
        "1.1.1.1",
        "Chrome"
    );

    // Assert
    Assert.NotNull(result);
    Assert.Equal(SabicConstants.SuccessStatusCode, result.StatusCode);
    Assert.False(string.IsNullOrEmpty(result.Token));
}



[Fact]
public async Task AuthenticateAsync_WhenRoleIsZero_ReturnsUnauthorized()
{
    var users = new List<UserAuth>
    {
        new UserAuth { UserID = 1, RoleID = 0 }
    };

    var accountRepoMock = new Mock<IAccountRepository>();
    var loggingRepoMock = new Mock<ILoggingRepository>();

    accountRepoMock
        .Setup(x => x.GetUserbyLoginIdAsync(It.IsAny<string>()))
        .ReturnsAsync(users);

    var service = new AuthenticationService(
        Options.Create(new JwtSettings()),
        accountRepoMock.Object,
        loggingRepoMock.Object
    );

    var result = await service.AuthenticateAsync("user", "1.1.1.1", "Chrome");

    Assert.Equal(SabicConstants.UnAuthorizedStatusCode, result.StatusCode);
}
